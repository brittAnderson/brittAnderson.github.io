<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Idle Idea Idylls - Using Your Camera As A Webcam</title>
        <link rel="stylesheet" href="../css/vanilla.css" />
    </head>
    <body>
        <header>
            <div class="logo">
                <a href="../">Idle Idea Idylls</a>
            </div>
            <nav>
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </nav>
        </header>

        <main role="main">
            <h1>Using Your Camera As A Webcam</h1>
            <article>
    <section class="header">
        Posted on August  5, 2020
        
            by Britt Anderson
        
    </section>
    <section>
        <p>This is a popular topic in the era of work from home and remote presentations. I just wanted to post as landmarks a couple of useful links I found helpful. In addition I want to point out that you can make most of this work in Linux and using Nixos in particular if you are so inclined.</p>
<p>The easiest route if you are a Windows or Mac user is to simply buy a supported Canon camera and use their <a href="https://www.canon.ca/en/Features/EOS-Webcam-Utility" title="Canon Canada Beta Webcam">beta software</a>. Then everything seems to just work. However, if you are on linux the story is more complicated.</p>
<p>One option is to buy the cheapest HDMI-USB video converter you can find and cross your fingers the lag is adequate for your use.</p>
<p>Another option is to search the <a href="http://gphoto.org/proj/libgphoto2/support.php" title="gphoto2 supported cameras">gphoto2</a> list of supported cameras and then, if yours is supported, search for specfic instructions.</p>
<p>In my case I followed the advice in this <a href="https://youtu.be/EqrZrKC1WA0" title="Using OBS to Stream Without special software">youtube video</a> and set up a loopback device. The packages you need are shown for Ubuntu and the pace is slow, but methodical. You can skim if you know what you are doing. If you do not this is a nice overview.</p>
<p>As I tried to get things in my nixos installation working I tried a bunch of settings and packages. I will list them here, but they may not all be necessary for you.</p>
<p>First, are the changes I made to my <code>configuration.nix</code></p>
<p>I set a kernel package:</p>
<p><code>boot.extraModulePackages = with config.boot.kernelPackages; [ v4l2loopback ];</code></p>
<p>I also installed the package <code>linuxPackages.v4l2loopback</code> and some others for my applications and uses. The <code>screenkey</code> program allows you to show keypresses on the screen and is useful for screencasting.</p>
<pre><code>zoom-us
ffmpeg
gphoto2
screenkey</code></pre>
<p>And I enabled the gphoto option <code>programs.gphoto2.enable=true;</code></p>
<p>For reasons I can't quite remember I decided to only make the obs_studio package available for my user account, and I added the camera to my list of extra groups:</p>
<pre><code>extraGroups = [ &quot;wheel&quot; &quot;networkmanager&quot; &quot;adbusers&quot; &quot;camera&quot;];
packages =  with pkgs; [
	pkgs.obs-studio </code></pre>
<p>Then if all that installs, compiles and works well you can plug in your camera from its USB out to a USB port on your computer and then reboot all. In a terminal check if gphoto2 can find your camera with <code>gphoto2 --autodetect</code></p>
<p>Figure out the names of your video devices with <code>ls /dev/video*</code> and then</p>
<pre><code>sudo modprobe v4l2loopback</code></pre>
<p>and repeat the <code>ls</code> command to identify the new device, and use it to run:</p>
<pre><code>  gphoto2 --stdout --capture-movie | ffmpeg -i - -vcodec rawvideo 
	  -pix_fmt yuv420p -threads 0 -f v4l2 /dev/video2
  </code></pre>
<p>Now you should have a dummy device you can use in obs or zoom or pretty much any application.</p>
    </section>
</article>

        </main>

        <footer>
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </footer>
    </body>
</html>
